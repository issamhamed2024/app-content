(function(){var e={6204:function(e,t,a){"use strict";var r=a(5130),s=a(6768);function n(e,t,a,r,n,o){const l=(0,s.g2)("notifications"),i=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.bF)(l,{position:"top center"}),(0,s.bF)(i)])}a(323);var o={name:"App"},l=a(1241);const i=(0,l.A)(o,[["render",n]]);var d=i,c=a(7278),u=a(1387),m=a(4232);const p=e=>((0,s.Qi)("data-v-afe0a82e"),e=e(),(0,s.jt)(),e),h={class:"form-container"},f=p((()=>(0,s.Lk)("h1",null,"تقديم النموذج",-1))),g=p((()=>(0,s.Lk)("label",null,"الاسم:",-1))),b={key:0,class:"error"},v=p((()=>(0,s.Lk)("label",null,"رقم الهاتف:",-1))),y={key:1,class:"error"},k=p((()=>(0,s.Lk)("button",{type:"submit"},"إرسال",-1))),L={key:2,class:"error"};function x(e,t,a,n,o,l){return(0,s.uX)(),(0,s.CE)("div",h,[f,(0,s.eW)("awsedgfyhj "),(0,s.Lk)("form",{onSubmit:t[2]||(t[2]=(0,r.D$)(((...e)=>l.submitForm&&l.submitForm(...e)),["prevent"])),class:"form"},[g,(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>o.name=e),required:""},null,512),[[r.Jo,o.name]]),o.errors.name?((0,s.uX)(),(0,s.CE)("span",b,(0,m.v_)(o.errors.name),1)):(0,s.Q3)("",!0),v,(0,s.bo)((0,s.Lk)("input",{type:"tel","onUpdate:modelValue":t[1]||(t[1]=e=>o.phoneNumber=e),required:"",placeholder:"+966"},null,512),[[r.Jo,o.phoneNumber]]),o.errors.phoneNumber?((0,s.uX)(),(0,s.CE)("span",y,(0,m.v_)(o.errors.phoneNumber),1)):(0,s.Q3)("",!0),k,o.formError?((0,s.uX)(),(0,s.CE)("span",L,(0,m.v_)(o.formError),1)):(0,s.Q3)("",!0)],32)])}var D=a(8355);const w="http://localhost:3000";var S={data(){return{name:"",phoneNumber:"+966",errors:{},formError:""}},methods:{async submitForm(){if(this.errors={},this.formError="",this.name||(this.errors.name="الرجاء إدخال الاسم"),this.phoneNumber||(this.errors.phoneNumber="الرجاء إدخال رقم الهاتف"),!(Object.keys(this.errors).length>0))try{await D.A.post(`${w}/api/forms`,{name:this.name,phoneNumber:this.phoneNumber}),alert("تم إرسال النموذج بنجاح!"),this.name="",this.phoneNumber=""}catch(e){console.log("error",e.message),this.formError="حدث خطأ أثناء إرسال النموذج. الرجاء المحاولة مرة أخرى."}}}};const T=(0,l.A)(S,[["render",x],["__scopeId","data-v-afe0a82e"]]);var C=T;const E=e=>((0,s.Qi)("data-v-22d070b5"),e=e(),(0,s.jt)(),e),N={class:"container-fluid text-end px-5 pb-5"},$={class:"row mb-4"},q={class:"col-sm-2"},A=E((()=>(0,s.Lk)("div",{class:"col-sm-8"},null,-1))),M={class:"col-sm-2"},U=(0,s.Fv)('<div class="col-sm-12 mt-5 pt-3" data-v-22d070b5></div><div class="col-sm-2" data-v-22d070b5><h1 class="" data-v-22d070b5>الممثلين</h1></div><div class="col-sm-8" data-v-22d070b5></div><div class="col-sm-2" data-v-22d070b5><button class="btn btn-warning" href="#" data-toggle="modal" data-target="#exampleModal" data-bs-toggle="modal" data-bs-target="#exampleModal" data-v-22d070b5>جديد</button></div>',4),F={class:"row pb-5"},_={style:{display:"none"}};function R(e,t,a,r,n,o){const l=(0,s.g2)("SearchForm"),i=(0,s.g2)("UserToggle"),d=(0,s.g2)("NewModal"),c=(0,s.g2)("UsersTable"),u=(0,s.g2)("ag-grid-vue");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",N,[(0,s.Lk)("div",$,[(0,s.Lk)("div",q,[(0,s.bF)(l,{searchText:n.searchText,"onUpdate:searchText":t[0]||(t[0]=e=>n.searchText=e)},null,8,["searchText"])]),A,(0,s.Lk)("div",M,[(0,s.bF)(i)]),U]),(0,s.Lk)("div",F,[(0,s.eW)((0,m.v_)(n.searchText)+" ",1),(0,s.bF)(d,{onReload:o.reloadData},null,8,["onReload"]),(0,s.bF)(c,{searchText:n.searchText,ref:"UsersTableRef"},null,8,["searchText"])])]),(0,s.Lk)("div",_,[(0,s.bF)(u,{columnDefs:n.columnDefs,rowData:o.filteredRequests,domLayout:"autoHeight",gridAutoHeight:!0,class:"ag-theme-quartz custom-ag-grid",enableRtl:!0,rowHeight:40,pagination:!0},null,8,["columnDefs","rowData"])])],64)}var P=a(3505),I=a(9122),O=a.n(I);const V={class:"input-group",id:"search"},j=(0,s.Lk)("span",{class:"btn btn-outline-secondary",style:{"padding-top":"10px !important"}},[(0,s.Lk)("i",{class:"fa-solid fa-magnifying-glass"})],-1);function J(e,t,a,n,o,l){return(0,s.uX)(),(0,s.CE)("div",V,[j,(0,s.bo)((0,s.Lk)("input",{type:"text",class:"form-control",placeholder:"بحث","onUpdate:modelValue":t[0]||(t[0]=e=>o.localSearchText=e),onInput:t[1]||(t[1]=(...e)=>l.updateSearchText&&l.updateSearchText(...e))},null,544),[[r.Jo,o.localSearchText]])])}var W={name:"SearchForm",props:["searchText"],data(){return{localSearchText:this.searchText}},methods:{updateSearchText(){this.$emit("update:searchText",this.localSearchText)}},watch:{searchText(e){this.localSearchText=e}}};const B=(0,l.A)(W,[["render",J]]);var H=B;const X={class:"dropdown",id:"user-dropdwon"},Q=(0,s.Lk)("button",{class:"btn dropdown-toggle text-start",type:"button",id:"dropdownMenuButton","data-bs-toggle":"dropdown","aria-expanded":"false"},[(0,s.Lk)("img",{src:"https://ps.w.org/user-avatar-reloaded/assets/icon-256x256.png?rev=2540745",alt:""}),(0,s.Lk)("strong",null,"عبد العزيز")],-1),z=(0,s.Lk)("ul",{class:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},[(0,s.Lk)("li",null,[(0,s.Lk)("a",{class:"dropdown-item",href:"#"},"تسجيل الخروج")])],-1),G=[Q,z];function Y(e,t,a,r,n,o){return(0,s.uX)(),(0,s.CE)("div",X,G)}var K={name:"UserToggle"};const Z=(0,l.A)(K,[["render",Y]]);var ee=Z;function te(e,t,a,r,n,o){const l=(0,s.g2)("ag-grid-vue");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=t=>e.handleClick(0))},"sss"),(0,s.bF)(l,{columnDefs:n.columnDefs,rowData:o.filteredDatas,defaultColDef:n.defaultColDef,quickFilterText:a.searchText,domLayout:"autoHeight",gridAutoHeight:!0,class:"ag-theme-quartz custom-ag-grid",enableRtl:!0,rowHeight:60,pagination:!0,getRowStyle:o.getRowStyle,onModelUpdated:o.onModelUpdated},null,8,["columnDefs","rowData","defaultColDef","quickFilterText","getRowStyle","onModelUpdated"])])}a(4114);var ae={name:"UsersTable",components:{AgGridVue:P.b},props:["searchText"],mounted(){this.getData()},data(){return{datas:[],columnDefs:[{field:"id",headerName:"#",width:50,cellClass:"text-center"},{field:"image",headerName:"الصورة",width:100,cellRenderer:this.renderImageCell},{field:"name",headerName:"الإسم"},{field:"gender",headerName:"الجنس",width:140},{field:"nationality",headerName:"الجنسية",width:140},{field:"city",headerName:"المدينة"},{field:"age",headerName:"العمر",width:140},{field:"price",headerName:"التكلفة",cellRenderer:this.renderPriceCell},{field:"mobile",headerName:"الجوال"},{field:"attachements",headerName:"الأعمال",width:140,cellClass:"text-center",cellRenderer:this.renderAttachementsCell},{field:"status",headerName:"الحالة",width:140,cellClass:"text-center",cellRenderer:this.renderSendButton},{field:"notes",headerName:"ملاحظات",width:140,cellClass:"text-center",cellRenderer:this.renderNotesCell},{field:"actions",headerName:"الإجراءات",width:140,cellClass:"text-center",cellRenderer:this.renderActionsCell}],defaultColDef:{resizable:!0,sortable:!0}}},computed:{filteredDatas(){let e=[];return this.datas.map(((t,a)=>{const r=t.image&&""!=t.image?`${w}/uploads/images/${t.image}`:`${w}/uploads/no-image.jpg`,s={id:a+1,image:r,name:t.name,gender:"male"==t.gender?"ذكر":"أنثى",nationality:t.nationality,city:t.city,age:t.age,price:t.price,mobile:t.mobile,attachements:1,status:t.status,notes:1,idd:t._id};e.push(s)})),e}},watch:{searchText(e){console.log("myProp changed:",e)}},methods:{onModelUpdated(e){const t=e.api.getDisplayedRowCount(),a=100+80*t;document.querySelector(".ag-center-cols-viewport").style.height=`${a}px`,console.log("Total row count after search:")},getRowStyle(e){const t=e.node.rowIndex,a=20+20*t;return{top:`${a}px`}},renderImageCell(e){const t=document.createElement("img");return t.src=e.value,t.alt=e.data.make,t.className="custom-image",t},renderPriceCell(e){return e.value.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")},renderAttachementsCell(){return'<a href="#" class="btn btn-x"><i class="fas fa-ellipsis-h"></i></a>'},renderSendButton(e){console.log(e);const t=document.createElement("div");return 1==e.value?(t.innerHTML="<span>فعال</span>",t.className="cursor-pointer badge text-success border border-success text-decoration-none px-3 py-1"):(t.innerHTML="<span>غير فعال</span>",t.className="cursor-pointer badge text-danger border border-danger text-decoration-none px-3 py-1"),this.addClickEventListenerButton(t,e.data),t},addClickEventListenerButton(e,t){e.addEventListener("click",(()=>this.sendPicture(t)))},async sendPicture(e){var t=e.idd,a=1==e.status?0:1;try{const e=await D.A.post(`${w}/api/admin/setDataStatus`,{id:t,status:a});1==e.data.status_?(this.$notify({type:"success",text:"تم تغيير الحالة بتجاح"}),this.getData()):(console.log(e.data.message),this.$notify({type:"error",text:"لقد وقع خطأ ما, الرجاء المحاولة من جديد "}))}catch(r){this.$notify({type:"error",text:"لقد وقع خطأ ما, الرجاء المحاولة من جديد "}),console.error("Error uploading file:",r)}},renderNotesCell(){return'<a href="#" class="btn btn-x"><i class="fas fa-ellipsis-h"></i></a>'},renderActionsCell(){return'<a href="#" class="btn btn-x"><i class="fas fa-ellipsis-h"></i></a>'},async getData(){try{const e=await D.A.get(`${w}/api/admin/getData`);1==e.data.status_?(this.datas=e.data.datas,console.log(e.data.datas)):(console.log(e.data.message),this.$notify({type:"error",text:"لقد وقع خطأ ما, الرجاء المحاولة من جديد "}))}catch(e){this.$notify({type:"error",text:"لقد وقع خطأ ما, الرجاء المحاولة من جديد "}),console.error("Error uploading file:",e)}}}};const re=(0,l.A)(ae,[["render",te]]);var se=re;const ne={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},oe={class:"modal-dialog modal-lg"},le=(0,s.Lk)("div",{class:"modal-header"},[(0,s.Lk)("h5",{class:"modal-title",id:"exampleModalLabel"},"إضافة جديد"),(0,s.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ie={class:"modal-body"},de={class:"row"},ce={class:"col-sm-6"},ue={class:"mb-3"},me=(0,s.Lk)("label",{class:"form-label"},"الصورة",-1),pe={class:"col-sm-6"},he={class:"mb-3"},fe=(0,s.Lk)("label",{class:"form-label"},[(0,s.eW)("الإسم "),(0,s.Lk)("span",{class:"text-danger"},"*")],-1),ge={class:"col-sm-6"},be={class:"mb-3"},ve=(0,s.Lk)("label",{class:"form-label"},[(0,s.eW)("الجنس "),(0,s.Lk)("span",{class:"text-danger"},"*")],-1),ye=(0,s.Lk)("option",{value:"male"},"ذكر",-1),ke=(0,s.Lk)("option",{value:"female"},"أنثى",-1),Le=[ye,ke],xe={class:"col-sm-6"},De={class:"mb-3"},we=(0,s.Lk)("label",{class:"form-label"},[(0,s.eW)("الجنسية "),(0,s.Lk)("span",{class:"text-danger"},"*")],-1),Se={class:"col-sm-6 mb-3"},Te=(0,s.Lk)("label",{class:"form-label"},[(0,s.eW)("المدينة "),(0,s.Lk)("span",{class:"text-danger"},"*")],-1),Ce={class:"input-group"},Ee=(0,s.Lk)("span",{class:"input-group-text"},[(0,s.Lk)("i",{class:"fas fa-globe"})],-1),Ne={class:"col-sm-6"},$e={class:"mb-3"},qe=(0,s.Lk)("label",{class:"form-label"},[(0,s.eW)("العمر "),(0,s.Lk)("span",{class:"text-danger"},"*")],-1),Ae={class:"col-sm-6"},Me=(0,s.Lk)("label",{class:"form-label"},[(0,s.eW)("التكلفة "),(0,s.Lk)("span",{class:"text-danger"},"*")],-1),Ue={class:"input-group"},Fe=(0,s.Lk)("span",{class:"input-group-text"},[(0,s.Lk)("i",{class:"fas fa-dollar-sign"})],-1),_e={class:"col-sm-6 mb-3"},Re=(0,s.Lk)("label",{class:"form-label"},[(0,s.eW)("الجوال "),(0,s.Lk)("span",{class:"text-danger"},"*")],-1),Pe={class:"input-group"},Ie=(0,s.Lk)("span",{class:"input-group-text"},[(0,s.Lk)("i",{class:"fa fa-phone"})],-1),Oe=(0,s.Lk)("div",{class:"col-sm-6 mb-3"},[(0,s.Lk)("label",{class:"form-label"},"الأعمال"),(0,s.Lk)("input",{type:"file",accept:"image/*",class:"form-control"})],-1),Ve={class:"col-sm-6"},je={class:"mb-3"},Je=(0,s.Lk)("label",{class:"form-label"},[(0,s.eW)("الحالة "),(0,s.Lk)("span",{class:"text-danger"},"*")],-1),We=(0,s.Lk)("option",{value:"1"},"فعال",-1),Be=(0,s.Lk)("option",{value:"0"},"غير فعال",-1),He=[We,Be],Xe={class:"col-sm-12"},Qe={class:"mb-3"},ze=(0,s.Lk)("label",{class:"form-label"},"ملاحظات",-1),Ge=(0,s.Lk)("div",{class:"modal-footer"},[(0,s.Lk)("button",{type:"button",class:"closeModalbtn btn btn-secondary","data-bs-dismiss":"modal"},"تراجع"),(0,s.Lk)("button",{type:"submit",class:"saveUserbtn btn btn-primary"},"حفظ الآن")],-1);function Ye(e,t,a,n,o,l){return(0,s.uX)(),(0,s.CE)("div",ne,[(0,s.Lk)("div",oe,[(0,s.Lk)("form",{class:"modal-content",onSubmit:t[10]||(t[10]=(0,r.D$)(((...e)=>l.handleSubmit&&l.handleSubmit(...e)),["prevent"]))},[le,(0,s.Lk)("div",ie,[(0,s.Lk)("div",de,[(0,s.Lk)("div",ce,[(0,s.Lk)("div",ue,[me,(0,s.Lk)("input",{type:"file",accept:"image/*",class:"form-control",onChange:t[0]||(t[0]=(...e)=>l.handleImage&&l.handleImage(...e))},null,32)])]),(0,s.Lk)("div",pe,[(0,s.Lk)("div",he,[fe,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>o.formData.name=e),class:"form-control",required:""},null,512),[[r.Jo,o.formData.name]])])]),(0,s.Lk)("div",ge,[(0,s.Lk)("div",be,[ve,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>o.formData.gender=e),id:"",class:"form-control",required:""},Le,512),[[r.u1,o.formData.gender]])])]),(0,s.Lk)("div",xe,[(0,s.Lk)("div",De,[we,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>o.formData.nationality=e),class:"form-control",required:""},null,512),[[r.Jo,o.formData.nationality]])])]),(0,s.Lk)("div",Se,[Te,(0,s.Lk)("div",Ce,[Ee,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>o.formData.city=e),class:"form-control",required:""},null,512),[[r.Jo,o.formData.city]])])]),(0,s.Lk)("div",Ne,[(0,s.Lk)("div",$e,[qe,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>o.formData.age=e),class:"form-control",required:""},null,512),[[r.Jo,o.formData.age]])])]),(0,s.Lk)("div",Ae,[Me,(0,s.Lk)("div",Ue,[Fe,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=e=>o.formData.price=e),class:"form-control",required:""},null,512),[[r.Jo,o.formData.price]])])]),(0,s.Lk)("div",_e,[Re,(0,s.Lk)("div",Pe,[Ie,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=e=>o.formData.mobile=e),class:"form-control",required:""},null,512),[[r.Jo,o.formData.mobile]])])]),Oe,(0,s.Lk)("div",Ve,[(0,s.Lk)("div",je,[Je,(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>o.formData.status=e),id:"",class:"form-control",required:""},He,512),[[r.u1,o.formData.status]])])]),(0,s.Lk)("div",Xe,[(0,s.Lk)("div",Qe,[ze,(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[9]||(t[9]=e=>o.formData.notes=e),class:"form-control",rows:"5"},null,512),[[r.Jo,o.formData.notes]])])])])]),Ge],32)])])}var Ke={name:"NewModal",data(){return{image:null,attachements:null,formData:{name:"",gender:"male",nationality:"",city:"",age:30,price:"",mobile:"",status:1,notes:""}}},methods:{handleImage(e){this.image=e.target.files[0]},async handleSubmit(){document.querySelector(".saveUserbtn").disabled=!0,document.querySelector(".closeModalbtn").disabled=!0;const e=new FormData;e.append("imageData",this.image),e.append("name",this.formData.name),e.append("gender",this.formData.gender),e.append("nationality",this.formData.nationality),e.append("city",this.formData.city),e.append("age",this.formData.age),e.append("price",this.formData.price),e.append("mobile",this.formData.mobile),e.append("status",this.formData.status),e.append("notes",this.formData.notes);try{const t=await D.A.post(`${w}/api/admin/saveData`,e,{headers:{"Content-Type":"multipart/form-data"}});1==t.data.status_?(this.$notify({type:"success",text:"تم الحفظ بنجاح"}),this.$emit("reload")):(console.log(t.data.message),this.$notify({type:"error",text:"لقد وقع خطأ ما, الرجاء المحاولة من جديد "}))}catch(t){this.$notify({type:"error",text:"لقد وقع خطأ ما, الرجاء المحاولة من جديد "}),console.error("Error uploading file:",t)}finally{document.querySelector(".saveUserbtn").disabled=!1,document.querySelector(".closeModalbtn").disabled=!1,document.querySelector(".closeModalbtn").click()}}}};const Ze=(0,l.A)(Ke,[["render",Ye]]);var et=Ze,tt={components:{NewModal:et,UsersTable:se,UserToggle:ee,SearchForm:H,AgGridVue:P.b},data(){return{searchText:"",requests:[],loading:!0,searchQuery:"",filteredImage:"",filteredSendDate:"",columnDefs:[{field:"id",headerName:"رقم",valueGetter:"node.rowIndex + 1"},{field:"name",headerName:"الاسم",sortable:!0},{field:"phoneNumber",headerName:"رقم الهاتف",sortable:!0},{headerName:"تحميل الصورة",cellRenderer:e=>{if(null!==e.data?._id){const t=document.createElement("div");return t.classList.add("btn-group"),t.innerHTML='\n                  <input\n                     className="upload__inputfile d-none"\n                     type="file"\n                     multiple=""\n                     data-max_length="20"\n                    name="imageData"\n                    accept="image/*"\n                    />\n            ',this.addClickEventListener(t,e.data),t}return""}},{headerName:"الصورة",cellRenderer:e=>{if(e.data?.urlPicture){const t=document.createElement("div");return t.classList.add("btn-group"),t.innerHTML=`\n                  <a href="${e.data?.urlPicture}" target="_blank" class="btn btn-info">فتح الصورة</a>`,t}return""}},{headerName:"إرسال",cellRenderer:this.renderSendButton},{field:"creationDate",headerName:"تاريخ الإنشاء",valueFormatter:e=>{const t=new Date(e.value),a=`${t.getMonth()+1}/${t.getDate()}/${t.getFullYear()} ${t.getHours()}:${t.getMinutes()}:${t.getSeconds()}`;return a}},{field:"sendDate",headerName:"تاريخ الإرسال",valueFormatter:e=>{if(e.value){const t=new Date(e.value),a=`${t.getMonth()+1}/${t.getDate()}/${t.getFullYear()} ${t.getHours()}:${t.getMinutes()}:${t.getSeconds()}`;return a}}}]}},methods:{updateSearchText(e){this.searchText=e},reloadData(){this.$refs.UsersTableRef.getData()},async takePhoto(e,t){this.loading=!0;const a=t?._id;try{const t=e.target.files[0];if(t){const e=new FormData;e.append("imageData",t),e.append("orderId",a);const r=await D.A.post(`${w}/api/admin/uploadPhoto`,e,{headers:{"Content-Type":"multipart/form-data"}});200===r.status&&(this.fetchRequests(),alert("تم التقاط الصورة !")),this.loading=!1}}catch(r){this.loading=!1,console.error("Erreur lors de la prise de la photo :",r)}},async exportCSV(){try{const e=await D.A.get(`${w}/api/admin/export-csv`);console.log("response",e.data)}catch(e){console.log(e.message)}},renderSendButton(e){const t=e.data?.urlPicture;if(t){const t=document.createElement("div");return t.classList.add("btn-group"),t.innerHTML='<button class="btn btn-success">إرسال</button>',this.addClickEventListenerButton(t,e.data),t}return""},addClickEventListenerButton(e,t){e.addEventListener("click",(()=>this.sendPicture(t)))},addClickEventListener(e,t){e.addEventListener("change",(e=>this.takePhoto(e,t)))},async fetchRequests(){try{const e=await D.A.get(`${w}/api/admin/requests`);this.requests=e.data,this.loading=!1}catch(e){this.loading=!1,console.log("errer",e.message)}},filterByImage(e){this.resetFilters(),this.filteredImage=e},async sendPictureToManager(e,t){var a=O().stringify({token:"x1y1nwz2fbss9sj8",to:966563466639,image:e,caption:t}),r={method:"post",url:"https://api.ultramsg.com/instance82295/messages/image",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:a};(0,D.A)(r).then((function(e){console.log(JSON.stringify(e.data))})).catch((function(e){console.log(e)}))},async sendPicture(e){try{this.loading=!0;const t=`${e?.urlPicture}`,a=O().stringify({token:"x1y1nwz2fbss9sj8",to:e?.phoneNumber,image:t,caption:"جزاكم الله خيرًا ، ونسأل الله أن يجعل ذلك في ميزان حسناتكم."}),r={method:"post",url:"https://api.ultramsg.com/instance82295/messages/image",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:a},s=await(0,D.A)(r);console.log(JSON.stringify(s.data)),await D.A.post(`${w}/api/admin/update-send-date/${e?._id}`),await this.sendPictureToManager(t,e?.name),this.loading=!1,alert("تم إرسال الصورة إلى رقم الواتساب!")}catch(t){this.loading=!1,console.error(t)}},filterBySendDate(e){this.resetFilters(),this.filteredSendDate=e},resetFilters(){this.searchQuery="",this.filteredImage=null,this.filteredSendDate=null}},computed:{totalOrders(){return this.requests.length},ordersWithImages(){return this.requests.filter((e=>e.urlPicture)).length},ordersWithoutImages(){return this.requests.filter((e=>!e.urlPicture)).length},ordersWithSendDate(){return this.requests.filter((e=>e.sendDate)).length},ordersWithoutSendDate(){return this.requests.filter((e=>!e.sendDate)).length},filteredRequests(){let e=this.requests.filter((e=>e.name.includes(this.searchQuery)));return null!==this.filteredImage&&(e=e.filter((e=>this.filteredImage?e.urlPicture:!e.urlPicture))),null!==this.filteredSendDate&&(e=e.filter((e=>this.filteredSendDate?e.sendDate:!e.sendDate))),e}},mounted(){const e=document.querySelector(".modal-backdrop");e&&e.parentNode.removeChild(e),this.fetchRequests(),this.filteredImage=null,this.filteredSendDate=null}};const at=(0,l.A)(tt,[["render",R],["__scopeId","data-v-22d070b5"]]);var rt=at;const st=e=>((0,s.Qi)("data-v-1e1c2ae8"),e=e(),(0,s.jt)(),e),nt={class:"login-container"},ot=st((()=>(0,s.Lk)("h1",null,"تسجيل الدخول",-1))),lt=st((()=>(0,s.Lk)("label",null,"اسم المستخدم:",-1))),it=st((()=>(0,s.Lk)("label",null,"كلمة المرور:",-1))),dt=st((()=>(0,s.Lk)("button",{type:"submit"},"تسجيل الدخول",-1))),ct={key:0,class:"error"};function ut(e,t,a,n,o,l){return(0,s.uX)(),(0,s.CE)("div",nt,[ot,(0,s.Lk)("form",{onSubmit:t[2]||(t[2]=(0,r.D$)(((...e)=>l.login&&l.login(...e)),["prevent"])),class:"login-form"},[lt,(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>o.username=e),required:""},null,512),[[r.Jo,o.username]]),it,(0,s.bo)((0,s.Lk)("input",{type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>o.password=e),required:""},null,512),[[r.Jo,o.password]]),dt,o.loginError?((0,s.uX)(),(0,s.CE)("span",ct,(0,m.v_)(o.loginError),1)):(0,s.Q3)("",!0)],32)])}var mt={data(){return{username:"",password:"",loginError:""}},methods:{async login(){try{const e=await D.A.post(`${w}/api/admin/login`,{username:this.username,password:this.password});console.log("response",e),localStorage.setItem("isAuthenticated",!0),this.$router.push({name:"Admin"})}catch(e){e.response&&401===e.response.status?this.loginError="اسم المستخدم أو كلمة المرور غير صحيحة. الرجاء المحاولة مرة أخرى.":this.loginError="حدث خطأ أثناء عملية تسجيل الدخول. الرجاء المحاولة مرة أخرى لاحقًا."}}}};const pt=(0,l.A)(mt,[["render",ut],["__scopeId","data-v-1e1c2ae8"]]);var ht=pt;const ft=[{path:"/",name:"Form",component:C},{path:"/admin",name:"Admin",component:rt,meta:{requiresAuth:!0}},{path:"/login",name:"Login",component:ht}],gt=(0,u.aE)({history:(0,u.LA)(),routes:ft});gt.beforeEach(((e,t,a)=>{const r=localStorage.getItem("isAuthenticated");e.matched.some((e=>e.meta.requiresAuth))?r?a():a({name:"Login"}):a()}));var bt=gt;(0,r.Ef)(d).mount("#app");const vt=(0,r.Ef)(d);vt.use(bt),vt.use(c.Ay),vt.mount("#app")},2634:function(){}},t={};function a(r){var s=t[r];if(void 0!==s)return s.exports;var n=t[r]={exports:{}};return e[r].call(n.exports,n,n.exports,a),n.exports}a.m=e,function(){var e=[];a.O=function(t,r,s,n){if(!r){var o=1/0;for(c=0;c<e.length;c++){r=e[c][0],s=e[c][1],n=e[c][2];for(var l=!0,i=0;i<r.length;i++)(!1&n||o>=n)&&Object.keys(a.O).every((function(e){return a.O[e](r[i])}))?r.splice(i--,1):(l=!1,n<o&&(o=n));if(l){e.splice(c--,1);var d=s();void 0!==d&&(t=d)}}return t}n=n||0;for(var c=e.length;c>0&&e[c-1][2]>n;c--)e[c]=e[c-1];e[c]=[r,s,n]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,r){var s,n,o=r[0],l=r[1],i=r[2],d=0;if(o.some((function(t){return 0!==e[t]}))){for(s in l)a.o(l,s)&&(a.m[s]=l[s]);if(i)var c=i(a)}for(t&&t(r);d<o.length;d++)n=o[d],a.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return a.O(c)},r=self["webpackChunkfront"]=self["webpackChunkfront"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=a.O(void 0,[504],(function(){return a(6204)}));r=a.O(r)})();
//# sourceMappingURL=app.6404eac3.js.map